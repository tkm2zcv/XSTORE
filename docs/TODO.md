# XSTOREプロジェクト TODO リスト

最終更新: 2025-10-29

## 概要

このドキュメントは、Twitterアカウント買取販売サイト（XSTORE）の現在の未完了タスクをまとめたものです。

---

## 実装完了状況サマリー

### 完了済み（100%実装済み）

#### 1. データベース & Supabase
- テーブル作成完了（accounts, purchase_requests, admins）
- サンプルデータ挿入済み（12アカウント、6申込、1管理者）
- Supabase MCP設定完了

#### 2. 認証システム
- NextAuth.js設定完了（Credentials Provider）
- ログインページ実装済み（`/admin/login`）
- bcryptによるパスワードハッシュ化実装済み
- 管理者アカウント作成済み（admin@xstore.com / admin123）
- ミドルウェア保護実装済み

#### 3. API Routes
- **アカウント管理API**
  - GET/POST `/api/accounts`
  - GET/PUT/DELETE `/api/accounts/[id]`
  - フィルター、ソート、ページネーション実装済み
- **買取申込管理API**
  - GET/POST `/api/purchase-requests`
  - GET/PUT `/api/purchase-requests/[id]`
  - レート制限実装済み

#### 4. バリデーション & エラーハンドリング
- Zod スキーマ定義完了
- API バリデーションヘルパー実装済み
- エラーハンドリングユーティリティ実装済み
- フロントエンドフォームバリデーション実装済み

#### 5. 公開ページ
- `/` - トップページ
- `/accounts` - 販売中アカウント一覧
- `/accounts/[id]` - アカウント詳細
- `/purchase` - 買取申込フォーム
- `/terms` - 利用規約
- `/privacy` - プライバシーポリシー

#### 6. 管理画面
- `/admin` - ダッシュボード（統計表示、最近の申込）
- `/admin/accounts` - アカウント一覧（フィルター、ページネーション）
- `/admin/accounts/new` - 新規アカウント出品フォーム
- `/admin/accounts/[id]/edit` - アカウント編集フォーム
- `/admin/requests` - 買取申込一覧（フィルター、ページネーション、ステータス更新）
- AdminSidebar、AccountTable、RequestTable、AccountForm等のコンポーネント実装済み

#### 7. パフォーマンス最適化
- Logger最適化（INFO level）
- Next.js config最適化（package imports、console removal）
- SVG画像サポート
- サイドバーアクティブ状態修正

---

## 未完了タスク

### 1. 画像アップロード機能（優先度: 高）

**チケット**: [017_画像アップロード機能.md](./017_画像アップロード機能.md)

**概要**: Supabase Storage を使用した画像アップロード機能の実装

**タスク**:
- [ ] Supabase Storage のバケット作成
  - [ ] `account-images` バケット（プロフィール画像用）
  - [ ] `purchase-images` バケット（買取申込の画像ツイート用）
  - [ ] パブリックアクセス設定
- [ ] 画像アップロード API の実装
  - [ ] `app/api/upload/account-image/route.ts` - アカウント画像アップロード
  - [ ] `app/api/upload/purchase-image/route.ts` - 買取申込画像アップロード
- [ ] 画像バリデーション機能
  - [ ] ファイルサイズチェック（最大5MB）
  - [ ] ファイル形式チェック（JPEG, PNG, WEBP）
  - [ ] 画像の寸法チェック
- [ ] 画像処理機能
  - [ ] リサイズ（プロフィール画像: 400x400px）
  - [ ] 圧縮（品質80%）
  - [ ] WEBP 変換（オプション）
- [ ] UI コンポーネントの実装
  - [ ] `ImageUpload` コンポーネント
  - [ ] ドラッグ&ドロップ対応
  - [ ] プレビュー機能
  - [ ] アップロード進捗表示

**依存関係**:
- チケット #016: 認証システム（完了）
- チケット #014: アカウント管理 API（完了）

**推奨実装順序**:
1. Supabase Storage バケット作成（Supabase Dashboard）
2. 画像処理ライブラリのインストール（`npm install sharp`）
3. 画像アップロードAPIの実装
4. ImageUploadコンポーネントの実装
5. 管理画面フォームへの統合
6. 買取申込フォームへの統合

**注意点**:
- サーバーサイドで画像処理を行う場合は `sharp` を使用
- クライアントサイドで処理する場合は Canvas API を使用
- WEBP形式への変換で容量削減を図る
- セキュリティ: アカウント画像は認証済みユーザーのみアップロード可能

---

### 2. テスト & デバッグ（優先度: 中）

**概要**: 全機能の動作確認とバグ修正

**タスク**:
- [ ] 公開ページのテスト
  - [ ] トップページの表示確認
  - [ ] アカウント一覧のフィルター・ソート動作確認
  - [ ] アカウント詳細ページの表示確認
  - [ ] 買取申込フォームの送信テスト
- [ ] 管理画面のテスト
  - [ ] ログイン・ログアウト動作確認
  - [ ] ダッシュボードの統計表示確認
  - [ ] アカウント管理（作成・編集・削除）動作確認
  - [ ] 買取申込管理（ステータス更新）動作確認
- [ ] API エンドポイントのテスト
  - [ ] 全エンドポイントのレスポンス確認
  - [ ] エラーハンドリング動作確認
  - [ ] バリデーション動作確認
  - [ ] 認証チェック動作確認
- [ ] レスポンシブデザイン確認
  - [ ] モバイル表示確認（375px, 768px, 1024px）
  - [ ] タブレット表示確認
  - [ ] デスクトップ表示確認
- [ ] パフォーマンス確認
  - [ ] Lighthouse Score 90+目標
  - [ ] ページロード時間確認
  - [ ] 画像最適化確認

---

### 3. SEO & メタデータ最適化（優先度: 中）

**概要**: SEO対策とメタデータの最適化

**タスク**:
- [ ] メタタグの実装
  - [ ] 各ページのタイトル・説明文設定
  - [ ] OGP画像の設定
  - [ ] Twitter Card設定
- [ ] sitemap.xml の生成
- [ ] robots.txt の作成
- [ ] 構造化データの実装（JSON-LD）
  - [ ] Organization スキーマ
  - [ ] Product スキーマ（アカウント詳細）

---

### 4. デプロイ準備（優先度: 中）

**概要**: 本番環境へのデプロイ準備

**タスク**:
- [ ] 環境変数の確認
  - [ ] `NEXTAUTH_URL` の本番URL設定
  - [ ] `NEXTAUTH_SECRET` の本番用シークレット生成
  - [ ] Supabase 本番環境の設定
- [ ] Vercel設定
  - [ ] プロジェクト作成
  - [ ] 環境変数設定
  - [ ] ビルド設定確認
- [ ] ドメイン設定
  - [ ] カスタムドメイン設定（任意）
  - [ ] SSL証明書確認
- [ ] 本番データベース準備
  - [ ] テーブル作成
  - [ ] 初期管理者アカウント作成
  - [ ] サンプルデータ投入（任意）

---

### 5. ドキュメント整備（優先度: 低）

**概要**: プロジェクトのドキュメント整備

**タスク**:
- [ ] README.md の更新
  - [ ] プロジェクト概要
  - [ ] セットアップ手順
  - [ ] 環境変数一覧
  - [ ] 開発・ビルドコマンド
- [ ] API仕様書の作成（任意）
- [ ] 運用マニュアルの作成（任意）

---

## 将来の拡張予定（Phase 2）

以下は現在のスコープ外で、将来的に実装を検討する機能です。

### 1. サイト内決済機能
- Stripe連携
- クレジットカード決済
- エスクローサービス

### 2. チャット機能
- リアルタイムチャット（Supabase Realtime）
- 管理者と購入希望者のコミュニケーション

### 3. レビュー・評価システム
- 取引後の評価
- レビュー表示

### 4. 検索履歴・お気に入り機能
- ユーザー登録機能
- お気に入りアカウント保存
- 検索履歴

### 5. メール通知
- 買取申込受付通知
- ステータス更新通知
- SendGrid / Resend連携

### 6. 多言語対応（i18n）
- Next.js i18n
- 英語対応

### 7. アナリティクス
- Google Analytics 連携
- アクセス解析
- コンバージョントラッキング

### 8. 画像削除機能
- 古い画像の自動削除
- ストレージ容量管理

---

## 現在の進捗状況

### 全体進捗
- **完了**: 90%
- **未完了**: 10%

### チケット進捗
- **完了**: 15/16チケット
- **未完了**: 1/16チケット（画像アップロード）

### 次のステップ

**最優先事項**:
1. 画像アップロード機能の実装（チケット #017）
2. 全機能のテストとデバッグ
3. 本番環境デプロイ

**推奨スケジュール**:
- Week 1: 画像アップロード機能実装
- Week 2: テスト & デバッグ
- Week 3: SEO最適化 & デプロイ準備
- Week 4: 本番デプロイ & 運用開始

---

## 技術スタック

- **フロントエンド**: Next.js 15 (App Router), TypeScript, Tailwind CSS, Shadcn/ui
- **バックエンド**: Next.js API Routes, Supabase (PostgreSQL)
- **認証**: NextAuth.js
- **バリデーション**: Zod
- **デプロイ**: Vercel
- **データベース**: Supabase (PostgreSQL)

---

## 連絡先・リソース

- **プロジェクト要件**: [CLAUDE.md](../CLAUDE.md)
- **チケット一覧**: [TICKETS_README.md](./TICKETS_README.md)
- **Supabase Dashboard**: Supabase MCP経由でアクセス
- **Vercel Dashboard**: デプロイ後に設定

---

**最終更新者**: Task Decomposition Analysis
**作成日**: 2025-10-29
